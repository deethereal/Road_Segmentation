# Распознавание дорог на спутниковых снимках
При помощи TensorFlow на открытых данных была обучена модель архитектуры U-Net сегментации автомобильных дорог на спутниковых снимках для дальнейшей навигации по местности.
### Сбор и обработка данных
Был написан [скрипт](https://github.com/deethereal/Road_Segmentation/blob/master/pic_download.py) для парсинга открытых данных. Это спутниковые снимки торонто с масками дорог на них. Все снимки имеют формат 1500x1500, некоторые из них были "битые". Парсился следующий [сайт](https://www.cs.toronto.edu/~vmnih/data/mass_roads/train/sat/index.html). Аналогичном образом были спарсены маски для этих снимков на этом [сайте](https://www.cs.toronto.edu/~vmnih/data/mass_roads/train/map/index.html). После чего все снимки были сжаты до размера 512x512 в силу нехватки мощности и времени на правильное "разрезание" картинок.  
Пример фрагмента изображения:  
![pc1](https://user-images.githubusercontent.com/48176611/131256768-c5346e69-a6b6-422e-a7bd-52c5835c40e7.png) 

### Модель
Была выбрана архитектура [U-Net](https://ru.wikipedia.org/wiki/U-Net), которая хорошо работает на сегментации при небольшой выборке. После чего Train выборка была поделена на **train/validation** в соотношении **4:1**. А также 16 тестовых изображений для визуальной проверки. Модель была глубиной в 7 слоев, оптимизировалась метрика **_accuracy_**, функция потерь &mdash; **_binarry_cross_entropy_**. Полученную модель можно найти в репозитории.    
Схема модели для RGB изображения 256x256:  
![Descr1](https://user-images.githubusercontent.com/48176611/131258449-d3e4a4fa-5fb9-4aa1-9e28-27d43cdba2f0.png)


### Резльтаты 

Удалось добиться  **_accuracy_**  в **0.9645** на валидационной выборке. Для примера рассмотрим три тестовых изображения, и как модель на них отработала.   
![testimg](https://user-images.githubusercontent.com/48176611/131258564-591f8859-f4fb-4371-90f1-c4a1c3ade89c.png)
